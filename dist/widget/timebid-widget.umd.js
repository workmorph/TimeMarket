!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TimeBidWidget={})}(this,(function(e){"use strict";class t{constructor(e){this.iframe=null,this.container=null,this.isConnected=!1,this.config={apiKey:e.apiKey,containerId:e.containerId,theme:e.theme||{},baseUrl:e.baseUrl||"https://api.timebid.com",onBidPlaced:e.onBidPlaced,onAuctionEnd:e.onAuctionEnd,onWidgetLoad:e.onWidgetLoad},this.init()}init(){try{if(this.container=document.getElementById(this.config.containerId),!this.container)throw new Error(`Container with ID '${this.config.containerId}' not found`);this.render(),this.setupEventListeners()}catch(e){console.error("TimeBid Widget initialization error:",e),this.renderError(e.message)}}render(){if(!this.container)return;this.container.innerHTML="",this.container.style.position="relative",this.container.style.overflow="hidden",this.container.style.minHeight="400px";const e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.backgroundColor="#f9f9f9",e.style.zIndex="1",e.innerHTML='<div style="width: 40px; height: 40px; border: 3px solid #ddd; border-top-color: #3498db; border-radius: 50%; animation: timebid-spin 1s linear infinite;"></div>';const t=document.createElement("style");t.textContent="@keyframes timebid-spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }",document.head.appendChild(t),this.container.appendChild(e);const i=document.createElement("iframe");i.src=`${this.config.baseUrl}/widget?key=${this.config.apiKey}&theme=${encodeURIComponent(JSON.stringify(this.config.theme))}`,i.style.width="100%",i.style.height="400px",i.style.border="none",i.style.position="relative",i.style.zIndex="2",i.style.opacity="0",i.style.transition="opacity 0.3s ease",i.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups"),i.setAttribute("title","TimeBid Auction Widget"),this.container.appendChild(i),this.iframe=i,i.onload=()=>{i.style.opacity="1",setTimeout((()=>{var t,i;e.parentNode&&e.parentNode.removeChild(e),null==(i=(t=this.config).onWidgetLoad)||i.call(t)}),300)}}setupEventListeners(){window.addEventListener("message",this.handleMessage.bind(this))}handleMessage(e){var t,i,n,o;if(e.origin!==this.config.baseUrl)return;const s=e.data;switch(s.type){case"TIMEBID_RESIZE":this.iframe&&s.height&&(this.iframe.style.height=`${s.height}px`);break;case"TIMEBID_BID_PLACED":s.bid&&(null==(i=(t=this.config).onBidPlaced)||i.call(t,s.bid));break;case"TIMEBID_AUCTION_END":s.auction&&(null==(o=(n=this.config).onAuctionEnd)||o.call(n,s.auction));break;case"TIMEBID_CONNECTED":this.isConnected=!0,console.log("Widget connected to TimeBid server");break;case"TIMEBID_ERROR":console.error("TimeBid Widget error:",s.error)}}renderError(e){if(!this.container)return;this.container.innerHTML="";const t=document.createElement("div");t.style.padding="20px",t.style.color="#721c24",t.style.backgroundColor="#f8d7da",t.style.border="1px solid #f5c6cb",t.style.borderRadius="4px",t.style.textAlign="center",t.innerHTML=`<strong>TimeBid Widget Error:</strong> ${e}`,this.container.appendChild(t)}refresh(){this.init()}isConnectedToServer(){return this.isConnected}destroy(){window.removeEventListener("message",this.handleMessage.bind(this)),this.container&&(this.container.innerHTML=""),this.iframe=null,this.isConnected=!1}}const i={createWidget:e=>new t(e),version:"1.0.0"};"undefined"!=typeof window&&(window.TimeBid=i),e.TimeBidWidget=t,e.default=i,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
//# sourceMappingURL=timebid-widget.umd.js.map
